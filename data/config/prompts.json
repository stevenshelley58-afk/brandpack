{
  "$schema": "./prompts.schema.json",
  "version": "2.0.0",
  "updated_at": "2025-01-15T00:00:00Z",
  "global": {
    "provider": "openai",
    "log_level": "info",
    "cache_enabled": true,
    "cache_ttl_seconds": {
      "scrape": 604800,
      "llm": 86400,
      "image": 86400
    }
  },
  "calls": {
    "scrape.review_summarize": {
      "model": {
        "provider": "openai",
        "name": "gpt-4o-mini",
        "temperature": 0.1,
        "max_tokens": 2000
      },
      "prompt": {
        "system": "You are a brand analyst. Extract tone, voice, proof points, pricing cues, target audience, and citations from the brand kernel. Return valid JSON only.",
        "user_template": "Brand kernel:\n{kernel}\n\nAnalyze this kernel and return a JSON object with this exact structure:\n{\n  \"tone\": [\"string\", \"string\"],\n  \"voice\": [\"string\", \"string\"],\n  \"proof_points\": [\"string\", \"string\"],\n  \"pricing_cues\": [\"string\", \"string\"],\n  \"target_audience\": \"string\",\n  \"citations\": [\"string\", \"string\"]\n}",
        "variables": ["kernel"],
        "outputs_expected": 1
      },
      "runtime": {
        "timeout_ms": 15000,
        "max_retries": 1,
        "cost_usd_limit": 0.50,
        "crawl": {
          "max_pages": 6,
          "max_total_kb": 300,
          "max_concurrency": 4,
          "per_request_timeout_ms": 5000,
          "total_timeout_ms": 15000
        }
      }
    },
    "ideas.generate": {
      "model": {
        "provider": "openai",
        "name": "gpt-4o-mini",
        "temperature": 0.9,
        "max_tokens": 3500
      },
      "prompt": {
        "system": "You are a senior creative strategist. You MUST produce exactly 20 distinct campaign concepts as a JSON array. Each idea must reference real evidence from the brand kernel. Use the field name 'supporting_evidence_keys' (NOT 'evidence_keys'). Return ONLY the JSON array (no markdown).",
        "user_template": "Brand kernel:\n{kernel}\n\nProduce exactly 20 campaign ideas as a JSON array with this structure:\n[\n  {\"id\": \"idea-01\", \"headline\": \"...\", \"angle\": \"...\", \"audience\": \"...\", \"format\": \"LinkedIn carousel\", \"supporting_evidence_keys\": [\"...\"]},\n  ...(20 total)\n]\n\nEach idea MUST have all 6 fields: id, headline, angle, audience, format, supporting_evidence_keys.",
        "variables": ["kernel"],
        "outputs_expected": 20
      },
      "runtime": {
        "timeout_ms": 30000,
        "max_retries": 1,
        "cost_usd_limit": 1.50
      }
    },
    "copy.generate": {
      "model": {
        "provider": "openai",
        "name": "gpt-4o-mini",
        "temperature": 0.7,
        "max_tokens": 4500
      },
      "prompt": {
        "system": "You are an on-brand copywriter. Produce five sequential blocks for the selected idea in JSON format. Carry narrative continuity and cite evidence keys for every claim.",
        "user_template": "Brand kernel:\n{kernel}\n\nSelected idea:\n{idea}\n\nReturn valid JSON with five blocks matching slots: hook, context, proof, objection, cta. Include character counts and evidence keys.",
        "variables": ["kernel", "idea"],
        "outputs_expected": 5
      },
      "runtime": {
        "timeout_ms": 35000,
        "max_retries": 1,
        "cost_usd_limit": 2.00
      }
    },
    "image.brief_generate": {
      "model": {
        "provider": "openai",
        "name": "gpt-4o-mini",
        "temperature": 0.8,
        "max_tokens": 1200
      },
      "prompt": {
        "system": "You are an art director. Build a concise image brief in JSON format honoring 4:5 aspect ratio and safe zones.",
        "user_template": "Brand kernel:\n{kernel}\n\nIdea:\n{idea}\n\nReturn valid JSON with: aspect_ratio (4:5), safe_zone_top (0.15), safe_zone_bottom (0.15), visual_direction, focal_point, copy_overlay_guidance, evidence_keys.",
        "variables": ["kernel", "idea"],
        "outputs_expected": 1
      },
      "runtime": {
        "timeout_ms": 25000,
        "max_retries": 1,
        "cost_usd_limit": 0.75
      }
    },
    "image.asset_generate": {
      "model": {
        "provider": "stability",
        "name": "stable-diffusion-xl",
        "temperature": 0.3,
        "max_tokens": 0
      },
      "prompt": {
        "system": "Render an image using the provided brief. Obey aspect and safe zone constraints.",
        "user_template": "Brief:\n{brief}\n\nReturn JSON with asset_url, safe_zone_overlay_url, validation report.",
        "variables": ["brief"],
        "outputs_expected": 1
      },
      "runtime": {
        "timeout_ms": 40000,
        "max_retries": 2,
        "cost_usd_limit": 1.00
      }
    }
  },
  "validation": {
    "length": {
      "min_chars": 60,
      "max_chars": 320,
      "per_slot": {
        "hook": { "min": 40, "max": 90 },
        "context": { "min": 120, "max": 220 },
        "proof": { "min": 140, "max": 260 },
        "objection": { "min": 100, "max": 180 },
        "cta": { "min": 40, "max": 90 }
      }
    },
    "continuity": {
      "enabled": true,
      "thresholds": {
        "tone_shift": 0.25,
        "fact_drift": 0.20
      }
    },
    "evidence_policy": {
      "required_for": ["ideas", "copy", "image_brief", "image_asset"],
      "allow_empty": false
    }
  },
  "budgets": {
    "max_cost_per_run": 6.00,
    "max_tokens_per_run": 55000,
    "alert_threshold_usd": 4.50,
    "per_stage": {
      "scrape.review_summarize": { "max_cost": 0.70, "max_tokens": 2500 },
      "ideas.generate": { "max_cost": 1.80, "max_tokens": 4000 },
      "copy.generate": { "max_cost": 2.50, "max_tokens": 5000 },
      "image.brief_generate": { "max_cost": 1.00, "max_tokens": 1500 },
      "image.asset_generate": { "max_cost": 1.50, "max_tokens": 0 }
    }
  },
  "presets": {
    "fast": {
      "description": "Cheapest models, strict caps, intended for quick reviews under budget.",
      "overrides": {
        "global": {
          "provider": "openai"
        },
        "calls": {
          "scrape.review_summarize": {
            "model": { "name": "gpt-4o-mini" },
            "runtime": {
              "crawl": { "max_total_kb": 220 },
              "timeout_ms": 10000,
              "cost_usd_limit": 0.30
            }
          },
          "ideas.generate": {
            "model": { "provider": "openai", "name": "gpt-4o-mini" },
            "runtime": { "cost_usd_limit": 0.80 }
          },
          "copy.generate": {
            "model": { "provider": "openai", "name": "gpt-4o-mini" },
            "runtime": { "cost_usd_limit": 1.00 }
          }
        },
        "budgets": {
          "max_cost_per_run": 3.00
        }
      }
    },
    "balanced": {
      "description": "Default quality-to-cost ratio used for most runs.",
      "overrides": {
        "calls": {
          "scrape.review_summarize": {
            "model": { "name": "claude-3-5-sonnet-20241022" }
          },
          "ideas.generate": {
            "model": { "provider": "anthropic", "name": "claude-3-5-sonnet-20241022" }
          },
          "copy.generate": {
            "model": { "provider": "anthropic", "name": "claude-3-5-sonnet-20241022" }
          }
        }
      }
    },
    "full": {
      "description": "Premium copy quality; upgrades only the copy stage model while keeping other stages balanced.",
      "overrides": {
        "calls": {
          "copy.generate": {
            "model": { "provider": "anthropic", "name": "claude-3-opus-20240229", "temperature": 0.65, "max_tokens": 6000 },
            "runtime": { "cost_usd_limit": 4.00 }
          }
        },
        "budgets": {
          "max_cost_per_run": 8.00
        }
      }
    }
  },
  "banned_phrases": ["game changer", "revolutionize", "synergy", "unlock your potential", "take it to the next level", "cutting-edge", "disrupt the industry", "move fast and break things", "all-in-one solution", "future-proof", "leverage ai magic", "paradigm shift"]
}
